<!DOCTYPE html>
<html lang="en">
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>machine learning | Sarah Shannon</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="machine learning" />
<meta property="og:locale" content="en" />
<meta name="description" content="detection of ancient Karez irrigation tunnels" />
<meta property="og:description" content="detection of ancient Karez irrigation tunnels" />
<link rel="canonical" href="http://localhost:4000/sarahrshannon.github.io/projects/5_project/" />
<meta property="og:url" content="http://localhost:4000/sarahrshannon.github.io/projects/5_project/" />
<meta property="og:site_name" content="Sarah Shannon" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-09-14T19:15:38+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="machine learning" />
<meta name="twitter:site" content="@ShannonClimate" />
<meta name="twitter:creator" content="@ShannonClimate" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-09-14T19:15:38+01:00","datePublished":"2024-09-14T19:15:38+01:00","description":"detection of ancient Karez irrigation tunnels","headline":"machine learning","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/sarahrshannon.github.io/projects/5_project/"},"url":"http://localhost:4000/sarahrshannon.github.io/projects/5_project/"}</script>
<!-- End Jekyll SEO tag -->

  <head>
    
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>

  Sarah Shannon


  | machine learning

</title>
<meta name="description" content="Personal website for Sarah Shannon climate scientist | expertise in modelling glaciers, river flow and sea-level rise">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22></text></svg>">

<link rel="stylesheet" href="/sarahrshannon.github.io/assets/css/main.css">
<link rel="canonical" href="http://localhost:4000/sarahrshannon.github.io/projects/5_project/">



  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="http://localhost:4000/sarahrshannon.github.io/">
       Sarah Shannon
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/sarahrshannon.github.io/">
              about
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          <!---->
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/sarahrshannon.github.io/skills/">
                computing
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/sarahrshannon.github.io/consultancy/">
                consultancy
                
              </a>
          </li>
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/sarahrshannon.github.io/publications/">
                publications
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/sarahrshannon.github.io/research/">
                research
                
              </a>
          </li>
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/sarahrshannon.github.io/software/">
                software development
                
              </a>
          </li>
          
          
          
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      <div class="post">

  <header class="post-header">
    <h1 class="post-title">machine learning</h1>
    <p class="post-description">detection of ancient Karez irrigation tunnels</p>
  </header>

  <article>
    <p>Climate change is causing water scarcity in many arid regions of the world.  Can we look to ancient technologies to help manage this dwindling resource? To explore this, I developed a machine learning model to detect the presence of ancient irrigation tunnels from satellite imagery. 
The model uses the Keras <a href="https://www.tensorflow.org/" target="_blank" rel="noopener noreferrer">TensorFlow</a> library to train and validate a convolutional neural network (CNN).</p>

<p>Karez or Qanat are ancient hand dug irrigation tunnels that have been used for thousands of years to transport groundwater over long distances in semi-arid regions. They are constructed by digging a gentle down sloping tunnel underground so that water can flow under gravity. The technique minimises water loss though evaporation and does not require any electrical pumping of ground water reserves, making the tunnels a sustainable source of water supply.   Air flow over the wells can be used to cool houses and buildings.
The tunnels are still used today for irrigation and domestic water supply in some regions of the world, although many have fallen into a state of disrepair. The tunnels are mostly found in countries along the old silk road, particularly in Afghanistan, Iran and Uzbekistan. 
Access to the tunnel is via a series of well-like vertical shafts which can be seen by satellite as a line of equally spaced circles.</p>

<p>To create training and test data, I visually selected Karez images using free 1m satellite imagery from the <a href="https://www.usgs.gov/centers/eros/science/usgs-eros-archive-commercial-satellites-orbview-3" target="_blank" rel="noopener noreferrer">OrbView-3</a> commercial satellite data (from USGS). I then used the TensorFlow library to train and test the image classifier using 2960 training images and 740 validation images. To expand the size of the training data I augmented the images using the Keras ImageDataGenerator function.</p>

<p>A Jupyter notebook containing the code is stored <a href="https://github.com/ClimateDataLab/TensorFlow-karez/blob/main/karez_cnn_build_nb.ipynb" target="_blank" rel="noopener noreferrer">here</a></p>

<p>The image classifier works well, detecting the presence of Karez tunnels with a precision of 95%. The next step is to productionise the model to run on multiple satellite tiles. This will enable mapping of the locations of tunnels across multiple countries in Asia.</p>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <picture>
    
    <img class="img-fluid rounded z-depth-1" src="/sarahrshannon.github.io/assets/img/example_train1.jpg" title="training image of zarez from OrbView-3 satellite">
</picture>

    </div>
    <div class="col-sm mt-3 mt-md-0">
        <picture>
    
    <img class="img-fluid rounded z-depth-1" src="/sarahrshannon.github.io/assets/img/example_train2.jpg" title="training image of qanat from OrbView-3 satellite">
</picture>

    </div> 
    <div class="col-sm mt-3 mt-md-0">
        <picture>
    
    <img class="img-fluid rounded z-depth-1" src="/sarahrshannon.github.io/assets/img/example_train3.jpg" title="training image of turpan from OrbView-3 satellite">
</picture>

    </div>     
</div>
<div class="caption">
    Example training images of Karez shafts. Data comes from the OrbView-3 commercial satellite data and has a resolution of 1m resolution.      
</div>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <picture>
    
    <source media="(max-width: 480px)" srcset="/sarahrshannon.github.io/assets/resized/my_pts-480x328.png"></source>
    
    <source media="(max-width: 800px)" srcset="/sarahrshannon.github.io/assets/resized/my_pts-800x547.png"></source>
    
    <img class="img-fluid rounded z-depth-1" src="/sarahrshannon.github.io/assets/img/my_pts.png" title="training images karez from OrbView-3 satellite in West of Kandahar, Afghanistan">
</picture>

    </div>
    <div class="col-sm mt-3 mt-md-0">
        <picture>
    
    <img class="img-fluid rounded z-depth-1" src="/sarahrshannon.github.io/assets/img/metrics.png" title="TensorFlow loss and accuracy curves">
</picture>

    </div>   
</div>
<div class="caption">
    Left: Visual selection of training images using an OrbView-3 tile located in Naru Kalay in the West of Kandahar, Afghanistan. Karez in orange, not karez in green. Right: training and validation loss and accuracy. 









</div>

  </article>

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    © Copyright 2024 Sarah R. Shannon.
    
    
    
  </div>
</footer>



  </body>

  <!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/sarahrshannon.github.io/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Medium Zoom JS -->
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/sarahrshannon.github.io/assets/js/zoom.js"></script>


<!-- Load Common JS -->
<script src="/sarahrshannon.github.io/assets/js/common.js"></script>

  
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-296297964"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());

  gtag('config', 'UA-296297964');
</script>




<!-- Panelbear Analytics - We respect your privacy -->
<script async src="https://cdn.panelbear.com/analytics.js?site=EyO3nzwd0ov"></script>
<script>
    window.panelbear = window.panelbear || function() { (window.panelbear.q = window.panelbear.q || []).push(arguments); };
    panelbear('config', { site: 'EyO3nzwd0ov' });
</script>



</html>
